.case-history
  %table.table.table-condensed.timeline
    %tbody    
      %tr{:class => "case-history-inspection case-history-inspection-#{kase.case_number}"}
        -unless kase.inspections.empty?
          %td 
            %span.arrow            
          %td.status 
            Inspected
          %td
            %table.table-nolines
              -unless kase.first_inspection.nil?
                %tr
                  %td.date=kase.first_inspection.inspection_date.strftime("%-m/%-d/%y")
                  %td 
                    Property was inspected
                    -unless kase.first_inspection.inspection_findings.first.nil?
                      , with a finding of 
                      %b #{kase.first_inspection.inspection_findings.first.finding}

        -else
          %td{:style => "width: 40px"}
          %td 
            -if kase.state == 'Open'
              A case for this property created. Inspection is pending.
            -else
              A case for this property created. No futher actions have occured. 
              %a{:href => "/pages/help"}
                Why?



      -unless kase.notifications.empty?
        %tr{:class => "case-history-notification case-history-notification-#{kase.case_number}"}
          %td
            %span.arrow                                    
          %td.status Notice Sent
          %td
            %table.table.table-nolines
              -kase.notifications.each do |n|
                %tr
                  %td.date=n.date.strftime("%-m/%-d/%y")
                  %td A notice of hearing was sent to the property owner.



      -unless kase.hearings.empty?
        %tr{:class => "case-history-hearing case-history-hearing-#{kase.case_number}"}
          %td
            %span.arrow                                    
          %td.status Case Heard
          %td
            %table.table-nolines
              -kase.hearings.each do |h|
                %tr
                  %td.date=h.hearing_date.strftime("%-m/%-d/%y")
                  %td
                    The case against this property #{h.date > Time.now ? 'will be' : 'was'} heard 
                    / with an initial judgment of ---





      -unless kase.judgement.nil?
        %tr{:class => "case-history-judgement case-history-judgement-#{kase.case_number}"}
          %td
            %span.arrow                                    
          %td.status Judgment Recorded
          %td
            %table.table-nolines
              -kase.hearings.each do |h|
                %tr
                  %td.date=h.hearing_date.strftime("%-m/%-d/%y")
                  %td
                    A judgment of 
                    %b
                      #{h.hearing_status}
                    was recorded



      / These are resolutions brought through a code enforcement case
      -unless kase.resolutions.empty?
        %tr{:class => "case-history-resolution case-history-resolution-#{kase.case_number}"}
          %td
            %span.arrow                                    
          %td.status Reset
          %td
            %table.table-nolines
            -@address.resolutions.each do |r|
              %tr
                %td
                  %span.arrow
                -if r.class == Demolition
                  %td.status 
                    Demolition
                  %td
                    %table.table-nolines
                      %tr
                        %td.date=r.date.strftime("%-m/%-d/%y")
                        %td This property was demolished by #{r.program_name}
                - elsif r.class == Foreclosure
                  %td.status Foreclosure
                  %td
                    %table.table-nolines
                      %tr
                        %td.date=r.date.strftime("%-m/%-d/%y")
                        %td This property was sent to code lien foreclosure
                - elsif r.class == Maintenance
                  %td.status Lot Cleared
                  %td
                    %table.table-nolines
                      %tr
                        %td.date=r.date.strftime("%-m/%-d/%y")
                        %td This lot was cleared by #{r.program_name}
                - else
                  %td
                    %td=r.class.to_s + ": " + r.date.strftime("%-m/%-d/%y")
